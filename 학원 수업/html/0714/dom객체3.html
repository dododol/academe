<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../css/style.css">

<style>

img{

	width:80px;
	height:80px;
}

#dred{
	width : 80%;
	height : 400px;
/* 	border: 1px solid blue; */
	margin: 1px;
	padding: 1px;
	display: flex;
	flex-direction: row;
	background: lightgray;
	
}
/* .dgr{

	float: left;
	width: calc(24% - 1%);

} */
.dgr{

	box-sizing: border-box;
	flex: 24%;
/* 	border: 1px solid green; */
	margin: 1px;
	height: 90%;
	padding: 2px;
	background: gray;

}

 #dred img{
 
 	width: 99%;
 	height: 75%;
 
 }
 


</style>

<script>

/* proc1 = () => {
	
	// 시작버튼이 사라지도록
	document.getElementById('start').style.display = "none";
	
} */

selimg = null;
proc1 = (but) => {
	// 시작버튼이 사라지도록
	but.style.display = "none";
	
	// stop()시 수행됬던 테두리를 지운다
	if(selimg != null)	selimg.style.border="none";
	
	
	
	gbut = but;
	
	
	// result1 검색
	vres1 = document.getElementById('result1')
	
	
	vid = setInterval(function(){ 
	
	// 첫번째 이미지를 선택 - result1 검색
	child = vres1.firstChild
	
	// 부모의 뒤로 이동 = appendChild()
	vres1.appendChild(child)
	
	}, 500);
	
}

stop = () => {
	
	// 확인버튼 나타내기
	gbut.style.display = "inline";
	
	// 종료하기
	clearInterval(vid);
	
    // 랜덤 발생 - img태그의 개수만큼 곱한다
    //vimg=document.getElementsByTagName('img');
    vimg = document.querySelectorAll('img');	//vimg[0], vimg[5], vimg[3]
    
    rand=Math.floor(Math.random()*vimg.length);
    
    // 랜덤 수에 해당하는 이미지 선택
    selimg = vimg[rand];
    
    // 선택된 이미지 테두리 설정
    selimg.style.border = "10px double red";

}

/* //this를 파라미터로 넘겨받은 호출 방식
proc2 = (vimg) => {

} */

window.onload = function() {
	
	// img태그를 검색하여 일괄등록
	vimg = document.querySelectorAll('#dred img');
	for(i = 0; i < vimg.length; i++) {
		vimg[i].addEventListener('click', saleProc);
	}

}
ptag=null;
saleProc = function() {
	
	//alert(this);
	
	// 이미 생성된 p태그를 삭제
	if(ptag != null) {
		// id=sale인 p요소를 검색
		//document.detElementById('sale').remove();
		ptag.remove();
	}
	
	
	// 랜덤으로 할인률을 생성(10~50 %)
	rand = parseInt(Math.random() * 41 + 10)
	
	text = "할인률 : " + rand + "%";
	
	// textNode를 생성
	tNode = document.createTextNode(text);
	
	// p태그 생성
	ptag = document.createElement('p');
	ptag.id="sale";
	
	// p태그에 tNode를 추가
	ptag.appendChild(tNode);
	
	// p태그를 .dgr에 추가 - 클릭한 이미지를 기준으로 부모를 검색
	this.parentNode.appendChild(ptag);
	
	// 한번 클릭 실행 후 더이상 실행되지 않도록 이벤트를 제거
	this.removeEventListener('click', saleProc);
	
}




</script>

</head>
<body>

<h3></h3>
<!-- <input type="button" value="시작" id="start" onclick="proc1()"> -->
<input type="button" value="시작" onclick="proc1(this)">
<input type="button" value="종료" onclick="stop()">
<br>
<div class="ddres" id="result1">

	<img src="../images/뱅쇼.jpg" alt="뱅쇼.jpg">
	<img src="../images/식품1.jpg" alt="식품1.jpg">
	<img src="../images/펭귄.jpg" alt="펭귄.jpg">
	<img src="../images/핫초코.jpg" alt="핫초코.jpg">
	<img src="../images/국화.jpg" alt="국화.jpg">
	<img src="../images/수국.jpg" alt="수국.jpg">

</div>
<br>
<hr color="red">

<h3>이벤트 설정<br>
각 태그마다 onclick=proc2(this) 방법으로 설정 <br>
스크립트에서 img를 검색하여 이벤트 일괄 등록방법<br>
.addEventlistener('click', 함수이름)

</h3>
<div id='dred'>

<!-- 	<div class="dgr"> <img onclick="proc2(this)" src="../images/수국.jpg" alt="수국.jpg"></div>
	<div class="dgr"> <img onclick="proc2(this)" src="../images/식품2.jpg" alt="식품2.jpg"></div>
	<div class="dgr"> <img onclick="proc2(this)" src="../images/영화1.jpg" alt="영화1.jpg"></div>
	<div class="dgr"> <img onclick="proc2(this)" src="../images/뱅쇼.jpg" alt="뱅쇼.jpg"></div> -->

	<div class="dgr"> <img src="../images/수국.jpg" alt="수국.jpg"></div>
	<div class="dgr"> <img src="../images/식품2.jpg" alt="식품2.jpg"></div>
	<div class="dgr"> <img src="../images/영화1.jpg" alt="영화1.jpg"></div>
	<div class="dgr"> <img src="../images/뱅쇼.jpg" alt="뱅쇼.jpg"></div>

</div>

</body>
</html>































